<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S6包官网 - PVZ改版</title>
    <link rel="stylesheet" href="style/style_index.css">
</head>
<body>
    <header class="header">
        <div class="logo-container">
            <img src="image/logo.png" alt="S6包Logo" class="logo"/>
        </div>
        <nav class="nav">
            <ul id="navLinks"></ul>
        </nav>
        <!--以下是新增的登录部分-->
        <div id="auth-status">
            <a href="login.html" id="login-link">登录</a>
            <a href="register.html" id="register-link">注册</a>
            <div id="user-menu" style="display:none">
                <span id="username-display"></span>
                <button id="logout-btn">登出</button>
            </div>
        </div>
    </header>

    <main class="main-content">
        <!-- 全屏背景图 -->
        <section class="hero">
            <div class="hero-content">
                <img src="image/logo-large.png" alt="S6包大型Logo" class="hero-logo"/>
                <div class="hero-text">
                    <h1>S6包 - PVZ改版</h1>
                    <p>由史上最英明的群主混包包手搓的麦版斗蛐蛐S6改</p>
                </div>
            </div>
            <div class="scroll-indicator">↓ 向下滚动 ↓</div>
        </section>

        <!-- 功能区域 -->
        <section class="features">
            <h2 class="section-title">功能列表</h2>
            <div id="featureGrid" class="feature-grid"></div>
        </section>
    </main>

    <footer class="footer">
        <a href="crew.html">S6包制作组 - 植物大战僵尸改版</a>
    </footer>
    <script type="module">
        import { checkAuth,getCurrentUser, logout } from './auth.js';
        
        document.addEventListener('DOMContentLoaded', async () => {
            const isLoggedIn = await checkAuth();
            const authStatus = document.getElementById('auth-status');
            const loginLink = document.getElementById('login-link');
            const registerLink = document.getElementById('register-link');
            const userMenu = document.getElementById('user-menu');
            const usernameDisplay = document.getElementById('username-display');
            const logoutBtn = document.getElementById('logout-btn');
            
            if (isLoggedIn) {
                const currentUser = getCurrentUser();
                usernameDisplay.textContent = currentUser.username;
                loginLink.style.display = 'none';
                registerLink.style.display = 'none';
                userMenu.style.display = 'block';
            } else {
                userMenu.style.display = 'none';
            }
            
            logoutBtn.addEventListener('click', async () => {
            await logout();
            window.location.reload();
            });
        });
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 导航菜单数据
            const navItems = [
                { name: '首页', url: '#' },
                { name: '联系我们', url: 'https://qun.qq.com/universal-share/share?ac=1&authKey=e/XmS/StxFSFkip3o562MWyyNlGv8ONuz/h2vj6C1nkP0KJopUcZWSYXzlPjuqgM&busi_data=eyJncm91cENvZGUiOiIxMDQyNTA4MjI4IiwidG9rZW4iOiJDalNQN2wxa1dkdVdycVAzLzNVNHEvNEVyZDg2TkpDTFozUnBONDZkTkVyejljSm1xcWVaT3U4YVhCMHprYm1QIiwidWluIjoiMzkzNDA3MjYxNCJ9&data=lgzhIrS8gF5aBRQt-kXGoYVPHRAXqLvTd6cd3oo04J8FsL0EqYNHdCbIaAiS8zkLsMQMp6ICreFV4sSKlIKh6g&svctype=4&tempid=h5_group_info' }
            ];

            // 功能按钮数据 - 每个功能包含名称、URL、图片和描述
            const features = [
                {
                    name: 'S6包 植物wiki',
                    url: 'plantlist.html',
                    image: 'image/wiki.jpg',
                    description: '最伟大的作品'
                },
                {
                    name: 'S6包 僵尸wiki',
                    url: 'zombielist.html',
                    image: 'image/wiki.jpg',
                    description: '第二伟大的作品'
                },
                {
                    name:'水友赛投稿',
                    url:'arrangement_sub.html',
                    image:'image/arrangement_sub.jpg',
                    description: '我看彳亍'
                },{
                    name:'提案列表',
                    url:'proposal_list.html',
                    image:'image/proposal.jpg',
                    description: '欢迎提出你的建议'
                },
                { 
                    name: '布阵器', 
                    url: 'arrange.html',
                    image: 'image/arrange.png',
                    description: '玉冰猫卷卷'
                },
                { 
                    name: '随机数生成器', 
                    url: 'random.html',
                    image: 'image/random.jpg',
                    description: '你相信概率吗'
                },
                {
                    name:"阵容测试数据上传（制作组专用）",
                    url:"arrangement_data.html",
                    image:"image/wiki.jpg",
                    description:"上传阵容测试数据"
                },
                /*
                { 
                    name: '评论页面（尚未完成）', 
                    url: 'comments.html',
                    image: 'image/random.jpg',
                    description: '测试中'
                },*/
                
                // 可以继续添加更多功能
                // { name: '新植物图鉴', url: 'plants.html', image: 'image/plants.png', description: '查看所有新增植物' },
                // { name: '关卡编辑器', url: 'editor.html', image: 'image/editor.png', description: '创建自己的PVZ关卡' }
            ];

            // 渲染导航菜单
            const navLinksContainer = document.getElementById('navLinks');
            navItems.forEach(item => {
                const li = document.createElement('li');
                const a = document.createElement('a');
                a.href = item.url;
                a.textContent = item.name;
                li.appendChild(a);
                navLinksContainer.appendChild(li);
            });

            // 渲染功能网格
            const featureGridContainer = document.getElementById('featureGrid');
            features.forEach(feature => {
                const featureCard = document.createElement('a');
                featureCard.href = feature.url;
                featureCard.className = 'feature-card';
                
                // 创建卡片内容
                featureCard.innerHTML = `
                    <div class="feature-image-container">
                        <img src="${feature.image}" alt="${feature.name}" class="feature-image"/>
                    </div>
                    <div class="feature-info">
                        <h3>${feature.name}</h3>
                        <p>${feature.description}</p>
                    </div>
                `;
                
                featureGridContainer.appendChild(featureCard);
            });

            // 平滑滚动效果
            document.querySelector('.scroll-indicator').addEventListener('click', function() {
                document.querySelector('.features').scrollIntoView({ 
                    behavior: 'smooth' 
                });
            });

            let isScrolling = false;
            window.addEventListener('wheel', function(e) {
                if (document.querySelector('.hero').getBoundingClientRect().top>=0 && !isScrolling) {
                    if (e.deltaY > 0) {
                        isScrolling = true;
                        document.querySelector('.features').scrollIntoView({ 
                            behavior: 'smooth' 
                        });
                        setTimeout(function() {
                            isScrolling = false;
                        }, 1000);
                    }
                }
            });
        });
    </script>
</body>
</html>